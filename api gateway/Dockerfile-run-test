# -----------------------------------------
# Dockerfile: Run tests only
# -----------------------------------------
FROM gradle:8.10.2-jdk21

# Create a working directory inside the container
WORKDIR /app

# Copy Gradle config first so Docker can cache dependencies if they rarely change
COPY build.gradle settings.gradle ./

# Pre-fetch dependencies to leverage Docker layer caching
RUN gradle --no-daemon dependencies

# Copy the rest of your project (source code, resources, etc.)
COPY . .

# If you want to run only integration tests, define them in build.gradle
# For example:
# task integrationTest(type: Test) { ... }
# Then call that specific task:
RUN gradle --no-daemon clean integrationTest

# If you only want to run unit tests or a general test suite, use:
# RUN gradle --no-daemon clean test

# No final ENTRYPOINT is needed since we're not running the app.
# The container just builds, runs tests, and exits.
